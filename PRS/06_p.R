a<-read.table("raw_pos_zscore")
colnames(a)<-c("Trait","female_r2","male_r2")
a<-within(a,{z=(female_r2 - male_r2)/sqrt((1-female_r2)/11832+(1-male_r2)/11053)
          female_se=sqrt((1-female_r2)/11832)
          male_se=sqrt((1-male_r2)/11053)
          p=2*(1-pnorm((female_r2-male_r2)/sqrt((1-female_r2)/11832+(1-male_r2)/11053)))})

write.table(a,"raw_R2_pos",quote=F,row.names=F)

b<-read.table("raw_neg_zscore")
colnames(b)<-c("Trait","female_r2","male_r2")
b<-within(b,{z=(female_r2-male_r2)/sqrt((1-female_r2)/11832+(1-male_r2)/11053)
          female_se=sqrt((1-female_r2)/11832)
          male_se=sqrt((1-male_r2)/11053)
          p=2*pnorm((female_r2-male_r2)/sqrt((1-female_r2)/11832+(1-male_r2)/11053))})
write.table(b,"raw_R2_neg",quote=F,row.names=F,col.names=F)

a<-read.table("tbv_pos_zscore")
colnames(a)<-c("Trait","female_r2","male_r2")
a<-within(a,{z=(female_r2-male_r2)/sqrt((1-female_r2)/11832+(1-male_r2)/11053)
          female_se=sqrt((1-female_r2)/11832)
          male_se=sqrt((1-male_r2)/11053)
          p=2*(1-pnorm((female_r2-male_r2)/sqrt((1-female_r2)/11832+(1-male_r2)/11053)))})

write.table(a,"tbv_R2_pos",quote=F,row.names=F)

b<-read.table("tbv_neg_zscore")
colnames(b)<-c("Trait","female_r2","male_r2")
b<-within(b,{z=(female_r2-male_r2)/sqrt((1-female_r2)/11832+(1-male_r2)/11053)
          female_se=sqrt((1-female_r2)/11832)
          male_se=sqrt((1-male_r2)/11053)
          p=2*pnorm((female_r2-male_r2)/sqrt((1-female_r2)/11832+(1-male_r2)/11053))})
write.table(b,"tbv_R2_neg",quote=F,row.names=F,col.names=F)

a<-read.table("height_pos_zscore")
colnames(a)<-c("Trait","female_r2","male_r2")
a<-within(a,{z=(female_r2-male_r2)/sqrt((1-female_r2)/11832+(1-male_r2)/11053)
          female_se=sqrt((1-female_r2)/11832)
          male_se=sqrt((1-male_r2)/11053)
          p=2*(1-pnorm((female_r2-male_r2)/sqrt((1-female_r2)/11832+(1-male_r2)/11053)))})

write.table(a,"height_R2_pos",quote=F,row.names=F)

b<-read.table("height_neg_zscore")
colnames(b)<-c("Trait","female_r2","male_r2")
b<-within(b,{z=(female_r2-male_r2)/sqrt((1-female_r2)/11832+(1-male_r2)/11053)
          female_se=sqrt((1-female_r2)/11832)
          male_se=sqrt((1-male_r2)/11053)
          p=2*pnorm((female_r2-male_r2)/sqrt((1-female_r2)/11832+(1-male_r2)/11053))})
write.table(b,"height_R2_neg",quote=F,row.names=F,col.names=F)

a<-read.table("confounder_7_pos_zscore")
colnames(a)<-c("Trait","female_r2","male_r2")
a<-within(a,{z=(female_r2-male_r2)/sqrt((1-female_r2)/11832+(1-male_r2)/11053)
         female_se=sqrt((1-female_r2)/11832)
          male_se=sqrt((1-male_r2)/11053)
          p=2*(1-pnorm((female_r2-male_r2)/sqrt((1-female_r2)/11832+(1-male_r2)/11053)))})

write.table(a,"confounder_7_R2_pos",quote=F,row.names=F)

b<-read.table("confounder_7_neg_zscore")
colnames(b)<-c("Trait","female_r2","male_r2")
b<-within(b,{z=(female_r2-male_r2)/sqrt((1-female_r2)/11832+(1-male_r2)/11053)
          female_se=sqrt((1-female_r2)/11832)
          male_se=sqrt((1-male_r2)/11053)
          p=2*pnorm((female_r2-male_r2)/sqrt((1-female_r2)/11832+(1-male_r2)/11053))})
write.table(b,"confounder_7_R2_neg",quote=F,row.names=F,col.names=F)
